<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Add Shipment</title>
	<style>
		.modal {
		    /*display: none;*/
		    position: fixed;
		    z-index: 1000;
		    left: 0;
		    top: 0;
		    width: 100%;
		    height: 100%;
		    background-color: rgba(0, 0, 0, 0.6);
		    overflow: auto;
		}
		
		.modal-content {
		    background-color: #fefefe;
		    margin: 5% auto;
		    padding: 20px;
		    border: 1px solid #888;
		    width: 40%;
		    border-radius: 8px;
		    position: relative;
		}
		
		.close, .close-notification, .close-view {
		    color: #aaa;
		    float: right;
		    font-size: 28px;
		    font-weight: bold;
		}
		
		.close:hover,
		.close:focus, .close-notification:hover,.close-view:hover,
		.close-notification:focus {
		    color: #ff0000dc;
		    text-decoration: none;
		    cursor: pointer;
		}
		
		/* Form Styling Inside Modal */
		legend {
		    font-size: 1.2em;
		    font-weight: bold;
		    margin-bottom: 10px;
		}
		
		label {
		    font-size: 1.1em;
		}
		
		input[type="text"], input[type="date"], input[type="number"] {
		    width: calc(100% - 22px);
		    padding: 10px;
		    border: 1px solid #ccc;
		    border-radius: 4px;
		    font-size: 16px;
		    margin-top: 8px;
		    margin-bottom: 20px;
		}
		
		.required {
		    color: red;
		}
		.action-btn {
		    background-color: transparent !important; /* Ensure no background color */
		    border-radius: none !important; /* Ensure no border */
		    cursor: pointer;
		    padding: 5px !important; /* Adjust padding */
		    font-size: 16px;
		}
		/* Style specifically for the icons inside action buttons */
		.action-btn i {
		    color: black !important;
		    /* Enforce icon color to black */
		}
		
		/* Change icon color on hover */
		.action-btn:hover i {
		    color: gray !important; /* Enforce hover color to gray */
		}
		button[type="submit"], button[type="reset"], button[type="button"] {
		    padding: 10px;
		    background-color: #007bff;
		    border: none;
		    color: white;
		    border-radius: 4px;
		    cursor: pointer;
		    font-size: 16px;
		    margin-top: 15px;
		    display: inline-block;
		    margin-right: 10px;
		}
		
		.action-button1 {
		    display: flex;
		    justify-content: center;
		}
		
		.action-button2 {
		    display: flex;
		    justify-content: center;
		}
		
		button[type="submit"]:hover, button[type="reset"]:hover, button[type="button"]:hover {
		    background-color: #0056b3;
		}
		/* Table for Shipment Lines */
		#lineTable {
		    width: 100%;
		    border-collapse: collapse;
		    margin-top: 15px;
		}
		
		#lineTable th, #lineTable td {
		    padding: 8px;
		    border: 1px solid #ddd;
		}
		
		#lineTable th {
		    background-color: #f4f4f4;
		}
		
		#lineTable td:last-child {
		    text-align:center;
		}
		
		.action-btn {
		    margin-right: 10px; /* Add space between action buttons */
		    display:inline-block;
		}
		
		#combinedTable td:first-child {
		    text-align: center;
		}
		
		#combinedTable td:last-child {
		    text-align: center;
		}
		
		/* Delete Confirmation Modal Styling */
		#deleteConfirmationModal {
		    display: none;
		    position: fixed;
		    z-index: 1002;
		    left: 0;
		    top: 0;
		    width: 100%;
		    height: 100%;
		    background-color: rgba(0, 0, 0, 0.6);
		    overflow: auto;
		}
		
		#deleteConfirmationModal .modal-content {
		    background-color: white;
		    margin: 15% auto;
		    padding: 20px;
		    width: 80%;
		    max-width: 400px;
		    border-radius: 10px;
		    position: relative;
		}
		
		.close-delete {
		    position: absolute;
		    right: 10px;
		    top: 10px;
		    font-size: 20px;
		    cursor: pointer;
		}
		
		
		.close-delete {
		    color: #aaa;
		    float: right;
		    font-size: 28px;
		    font-weight: bold;
		}
		
		.close-delete:hover,
		.close-delete:focus {
		    color: red;/* General Page Styling */
		.center-h1 {
		    text-align: center;
		    font-size: 2.5em;
		    font-weight: bold;
		}
		
		/* Header Buttons and Filters */
		.header-buttons {
		    display: flex;
		    justify-content: end;
		}
		
		button#addButton {
		    margin-right: 10px;
		}
		
		.header-btn {
		    margin-right: 10px; 
		    padding: 8px;
		    border: 0;
		    background-color: #007bff;
		    color: white;
		    border-radius: 4px;
		    cursor: pointer;
		    display: flex;
		    align-items: center;
		}
		.header-btn:hover {
		    background-color: #0056b3;
		}
		
		.header-actions {
		    display: flex;
		    justify-content: space-between;
		    align-items: center;
		    padding: 10px;
		    border: 1px;
		    margin-right:-20px;
		}
		
		.search-filter-options {
		    display: flex;
		    align-items: center;
		    padding: 10px;
		    gap: 5px;
		    margin-left:-20px;
		}
		
		.search-container {
		    position: relative;
		    width: 300px;
		    margin-right: 20px;
		}
		
		.search-input {
		    width: 100%;
		    padding: 10px 15px 10px 40px;
		    border: 1px solid #ccc;
		    border-radius: 4px;
		    font-size: 16px;
		    box-sizing: border-box;
		}
		
		.search-icon {
		    position: absolute;
		    left: 10px;
		    top: 50%;
		    transform: translateY(-50%);
		    font-size: 18px;
		    color: #aaa;
		}
		
		.dropdown {
		    padding: 8px;
		    border: 1px solid #ccc;
		    border-radius: 4px;
		    font-size: 16px;
		    width: 200px;
		}
		
		/* Table Styling */
		table {
		    width: 100%;
		    border-collapse: collapse;
		    margin-top: 20px;
		}
		
		th, td {
		    padding: 8px 12px;
		    border: 1px solid #ddd;
		}
		
		th {
		    background-color: #f4f4f4;
		}
		
		/* Modal Styling */
		.modal {
		    display: none;
		    position: fixed;
		    z-index: 1000;
		    left: 0;
		    top: 0;
		    width: 100%;
		    height: 100%;
		    background-color: rgba(0, 0, 0, 0.6);
		    overflow: auto;
		}
		
		.modal-content {
		    background-color: white;
		    margin: 15% auto;
		    padding: 20px;
		    width: 80%;
		    max-width: 600px;
		    border-radius: 10px;
		    position: relative;
		}
		
		.close, .close-delete, .close-notification,.close-view {
		    position: absolute;
		    right: 10px;
		    top: 10px;
		    font-size: 20px;
		    cursor: pointer;
		}
		
		.required {
		    color: red;
		}
		
		.action-button1, .action-button2 {
		    display: flex;
		    justify-content: flex-end;
		    gap: 10px;
		}
		
		fieldset {
		    margin-bottom: 20px;
		}
		
		    cursor: pointer;
		}
		
		
		/* Notification Modal Styling */
		#notificationModal {
		    display: none;
		    position: fixed;
		    z-index: 1001;
		    left: 0;
		    top: 0;
		    width: 100%;
		    height: 100%;
		    background-color: rgba(0, 0, 0, 0.6);
		    overflow: auto;
		}
		
		#notificationMessage {
		    text-align: center;
		    padding: 20px;
		}
	</style>
</head>
<body>
<div id="addShipmentFormModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="window.location='GoodsShipping'">&times;</span>
            <form id="addShipmentForm">
                <fieldset>
                    <legend>Enter Shipment Details</legend>
                    <!-- <label for="shipmentId">Shipment Id</label>
                    <input type="text" id="shipmentId" name="shipmentId" disabled><br><br> -->
                    
                    <label for="document_no">Document No:<span class="required">*</span></label>
                    <input type="text" id="document_no" name="document_no"><br><br>

                    <label for="document_date">Document Date:<span class="required">*</span></label>
                    <input type="date" id="document_date" name="document_date"><br><br>

                    <label for="customer_id">Customer ID:<span class="required">*</span></label>
                    <input type="text" id="customer_id" name="customer_id"><br><br>
                    
                    <!-- <label for="createdBy">Created By</label>
                    <input type="text" id="createdBy" name="createdBy" disabled><br><br>
                    
                    <label for="updatedBy">Updated By</label>
                    <input type="text" id="updatedBy" name="updatedBy" disabled><br><br> -->
                    
                    <fieldset>
                        <legend>Enter Shipment Line Details</legend>
                        <label for="product_id">Product ID:<span class="required">*</span></label>
                        <input type="text" id="product_id" name="product_id"><br><br>
    
                        <label for="quantity">Quantity:<span class="required">*</span></label>
                        <input type="number" id="quantity" name="quantity"><br><br>

                        <div class="action-button1" id="block" colspan="4">
                            <button type="button" onclick="addShipmentDetails()">Add Line</button>
                            <button type="button" onclick="cancelShipmentDetails()">Cancel</button>
                        </div>
                        
                        <!-- Shipment Line Table -->
                        <table id="lineTable">
                            <thead>
                                <tr>
                                    <th>Product ID</th>
                                    <th>Quantity</th>
                                    <th>Actions</th> 
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Dynamically filled with shipment line data -->
                            </tbody>
                        </table>
                    </fieldset>
                    <form action= "ShipmentServlet">
	                    <div class="action-button2">
	                    	<input type="hidden" id="shipment" name="shipment">
	                    	<input type="hidden" id="shipmentLine" name="shipmentLine">
	                        <button type="reset" onclick="window.location.reload()">Reset</button>
	                        <button type="submit" onclick="return setShipmentHeaderAndLineItems()">Submit</button>
	                    </div>
	                    </form>
                </fieldset>
            </form>
        </div>
    </div>
    <script>
    
    var prodId = document.getElementById("product_id");
    var quantity = document.getElementById("quantity");
    var lineDetails = document.getElementById("lineTable");
    var docNo = document.getElementById("document_no");
    /* var shipmentId = document.getElementById("shipmentId");
    shipmentId.value = params.get("newInvoiceId"); */
    var docDate = document.getElementById("document_date");
    var cusId = document.getElementById("customer_id");
    var createdby = "22";
    var updatedby = "22";
    var shipment = document.getElementById("shipment");
    var shimentLine = document.getElementById("shipmentLine")
    var shimentLineRows;
    var selectedRow;
    var shipmentDetails = document.getElementById("LineTable");
    
    function setShipmentHeaderAndLineItems()
    {
    	var message = "";
    	var newLine = "\n";
    	/* 
    	if(shipmentId.value == "")
    	{
    		message += "Shipment Id is empty";
    		message += newLine;
    	} */
    	if(docNo.value == "")
    	{
    		message += "DocumentNo. is empty";
    		message += newLine;
    	}
    	if(docDate.value == "")
    	{
    		message += "Document Date is empty";
    		message += newLine;
    	}
    	if(cusId.value == "")
    	{
    		message += "Customer Id is empty";
    		message += newLine;
    	}
    	if(createdby.value == "")
    	{
    		message += "Created By is empty";
    		message += newLine;
    	}
    	if(updatedby.value == "")
    	{
    		message += "Updated By is empty";
    		message += newLine;
    	}
    	if(message != "")
    	{
    		alert(message);
    		return false;
    	}
    	else
		{
    		/* shipment.value = shipmentId.value + "?" +  */
    		docNo.value + "?" + docDate.value + "?" + cusId.value + "?" + createdby.value + "?" + updatedby.value + "?";
    		shimentLineRows = shipmentDetails.getElementByTagName("tr");
    		for(let i = 1; i < shimentLineRows.length; i++)
    		{
    			shimentLine.value += shimentLineRows[i].childNodes[1].innerHTML + "?"
    					+ shimentLineRows[i].childNodes[2].innerHTML + "?"
    		}
    		return true;
		}    		
    }
    
    function addShipmentDetails()
    {
        var message="";
        var newLine="\n";
      
        if (prodId.value == "")
        {
            message +="Product Id is empty";
            message +=newLine;
        }                    
        if (quantity.value == "") 
        {
            message +="Quantity is empty";
            message +=newLine;  
        }
        if(message != "")
       	{
       		alert(message);
       	}
        else
        {
        	lineDetails.innerHTML += '<tr class="rows"><td>'  + prodId.value + "</td><td>" + quantity.value*1 + '</td><td><center><button onclick="editShipmentDetails(this)">Edit</button>&Tab;<button onclick="deleteShipmentDetails(this.parentNode.parentNode.parentNode)">Delete</button></center></td></tr>';
        	cancelShipmentDetails();
        }
    }
    
    function cancelShipmentDetails()
    {
    	prodId.value = "";
    	quantity.value = "";
    }
    
    function deleteShipmentDetails(deleteButton)
    {
        if(confirm("Are you sure you want to delete Product Id : "+ deleteButton.childNodes[0].innerHTML +'?'))
        {
            deleteButton.remove();
        }
        cancelUpdate();
        
    }
    
    function editShipmentDetails(rowsToEdit)
    {
        selectedRow=rowsToEdit;
        var editProdId=rowsToEdit.parentNode.parentNode.parentNode.childNodes[0].innerHTML;
        var editQty=rowsToEdit.parentNode.parentNode.parentNode.childNodes[1].innerHTML;
        prodId.value = editProdId;                 
        quantity.value = editQty;
        
        document.getElementById("block").innerHTML = '<center><button type="button" onclick="updateShipmentDetails(selectedRow)">Update</button>&Tab;<button type="button" onclick="cancelUpdate()">Cancel</button></center>';
    }
    
    function cancelUpdate()
    {
        cancelShipmentDetails();
        document.getElementById("block").innerHTML = '<center><button type="button" onclick="addShipmentDetails()">Add Line</button>&Tab;<button type="button" onclick="cancelShipmentDetails()">Cancel</button></center>';
    }

    function updateShipmentDetails(rowsToUpdate)
    {
        var message="";
        var newLine="\n";
      
        if (prodId.value == "")
        {
            message +="Product Id is empty";
            message +=newLine;
        }                    
        if (quantity.value == "") 
        {
            message +="Quantity is empty";
            message +=newLine;  
        }
        if(message != "")
       	{
       		alert(message);
       	}
        else
        {
        	rowsToUpdate.parentNode.parentNode.parentNode.childNodes[1].innerHTML = prodId.value;
        	rowsToUpdate.parentNode.parentNode.parentNode.childNodes[1].innerHTML = quantity.value*1;
        	cancelUpdate();
        }
    }

    </script>
</body>
</html>